# –ó–∞–¥–∞–Ω–∏–µ –ø–æ `SQL`

---
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∞–±–ª–∏—Ü—É `employees`, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ _—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö_ 
–∏ _—è–∑—ã–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è_, –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–Ω–∏ –≤–ª–∞–¥–µ—é—Ç:

| name       | lang      |
|:-----------|:----------|
| Nick       | C#        |
| Nick       | SQL       |
| Eva        | Rust      |
| Vika       | Rust      |
| Vika       | SQL       |
| ...        | ...       |

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–≤–ª–µ—á–µ—Ç –∏–º–µ–Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∑–Ω–∞—é—â–∏—Ö —è–∑—ã–∫ `SQL`,
–∞ —Ç–∞–∫–∂–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.
–ü—Ä–∏ —ç—Ç–æ–º —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –æ–¥–Ω–æ –∏–º—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É.

---
## –¢—É—Ç –Ω—É–∂–Ω–æ:
1. –≤—ã–±—Ä–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å `SQL`,
2. –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É –Ω–∏—Ö –µ—Å—Ç—å **–µ—â—ë —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —è–∑—ã–∫**.

## –ó–∞–ø—Ä–æ—Å:
```sql
SELECT name 
FROM employees 
GROUP BY name 
HAVING COUNT(DISTINCT lang) > 1    
    AND SUM(CASE WHEN lang = 'SQL' THEN 1 ELSE 0 END) > 0;
```

üîπ `COUNT(DISTINCT lang) > 1` ‚Äî –∑–Ω–∞—á–∏—Ç, –Ω–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —è–∑—ã–∫.  
üîπ `SUM(CASE WHEN lang = 'SQL' THEN 1 END) > 0` ‚Äî –∑–Ω–∞—á–∏—Ç, –∑–Ω–∞–µ—Ç SQL.

> –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –≤–ª–∞–¥–µ—é—â–∏—Ö **SQL + –µ—â—ë —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∏–º —è–∑—ã–∫–æ–º**. ‚úÖ

---
# –†–∞–∑–±–æ—Ä –ø–æ —à–∞–≥–∞–º ‚Äî –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞–ø—Ä–æ—Å

1. `FROM employees` ‚Äî –±–µ—Ä—ë–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã _(–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = –æ–¥–∏–Ω —è–∑—ã–∫ —É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)_.

2. `GROUP BY name` ‚Äî —Å—Ç—Ä–æ–∫–∏ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏; –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã _(—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)_ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è 
–æ–¥–Ω–∞ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞. –≠—Ç–æ –∫–ª—é—á: –ø–æ—Å–ª–µ `GROUP BY` –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —É–∂–µ **—Å –≥—Ä—É–ø–ø–∞–º–∏**, –∞ –Ω–µ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏.

3. `HAVING ...` ‚Äî `HAVING` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –≥—Ä—É–ø–ø—ã –ø–æ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º 
_(–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `WHERE`, –∫–æ—Ç–æ—Ä—ã–π —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏ **–¥–æ** –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏)_.

4. `COUNT(DISTINCT lang) > 1` ‚Äî —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **—Ä–∞–∑–ª–∏—á–Ω—ã—Ö** —è–∑—ã–∫–æ–≤ –≤ –≥—Ä—É–ø–ø–µ. `> 1` –æ–∑–Ω–∞—á–∞–µ—Ç: 
—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –º–∏–Ω–∏–º—É–º **2** —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞. –í–∞–∂–Ω–∞—è –¥–µ—Ç–∞–ª—å: `DISTINCT` –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –¥—É–±–ª–µ–π 
_(–µ—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –¥–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ `Nick, SQL`, —ç—Ç–æ –Ω–µ —É–≤–µ–ª–∏—á–∏—Ç —á–∏—Å–ª–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —è–∑—ã–∫–æ–≤)_.

5. `SUM(CASE WHEN lang = 'SQL' THEN 1 ELSE 0 END) > 0` ‚Äî –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≥—Ä—É–ø–ø—ã `CASE` –≤—ã–¥–∞—ë—Ç **1**, 
–µ—Å–ª–∏ `lang = 'SQL'`, –∏–Ω–∞—á–µ **0**. `SUM(...)` —Å—É–º–º–∏—Ä—É–µ—Ç —ç—Ç–∏ –µ–¥–∏–Ω–∏—Ü—ã –ø–æ –≥—Ä—É–ø–ø–µ ‚Äî 
–ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π —Å `SQL` —É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞. 
–£—Å–ª–æ–≤–∏–µ `> 0` –æ–∑–Ω–∞—á–∞–µ—Ç: –∑–Ω–∞–µ—Ç SQL —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏.



## –ü—Ä–∏–º–µ—Ä (–∏–Ω—Ç–µ—Ä–º–µ–¥. –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
–ò—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:  
Nick: C#, SQL ‚Üí –ì—Ä—É–ø–ø–∞ Nick: `COUNT(DISTINCT lang)=2`, `SUM(CASE‚Ä¶)=1` ‚Üí –ø—Ä–æ—Ö–æ–¥–∏—Ç.  
Eva: Rust ‚Üí `COUNT(DISTINCT)=1`, `SUM(...)=0` ‚Üí –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç.  
Vika: Rust, SQL ‚Üí `COUNT(DISTINCT)=2`, `SUM(...)=1` ‚Üí –ø—Ä–æ—Ö–æ–¥–∏—Ç.

## –ü–æ—á–µ–º—É —Ç–∞–∫, –∞ –Ω–µ —á–µ—Ä–µ–∑ WHERE?
- `WHERE` —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö –¥–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ ‚Äî –Ω–µ–ª—å–∑—è –≤ `WHERE` –ø—Ä–æ–≤–µ—Ä–∏—Ç—å ¬´–∑–Ω–∞–µ—Ç –ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ SQL –∏ –µ—â—ë —á—Ç–æ-—Ç–æ¬ª, 
–ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —É—Å–ª–æ–≤–∏–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ **–≤—Å–µ–π –≥—Ä—É–ø–ø–µ**. 
–ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–≥—Ä–µ–≥–∞—Ç—ã –∏ `HAVING`.



## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–∫–æ—Ä–æ—Ç–∫–æ)
- –ß–µ—Ä–µ–∑ `EXISTS` (–∏–Ω–æ–≥–¥–∞ –±—ã—Å—Ç—Ä–µ–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å –ø–æ `(name, lang)`):
```sql
SELECT DISTINCT e.name
FROM employees e
WHERE EXISTS (SELECT 1 FROM employees x WHERE x.name = e.name AND x.lang = 'SQL')
  AND EXISTS (SELECT 1 FROM employees y WHERE y.name = e.name AND y.lang <> 'SQL');
```

- –ß–µ—Ä–µ–∑ `JOIN`:
```sql
SELECT DISTINCT a.name
FROM employees a
JOIN employees b ON a.name = b.name
WHERE a.lang = 'SQL' AND b.lang <> 'SQL';
```

- –í `PostgreSQL` –º–æ–∂–Ω–æ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ —á–µ—Ä–µ–∑ `FILTER`:
```sql
HAVING COUNT(DISTINCT lang) > 1
   AND COUNT(*) FILTER (WHERE lang = 'SQL') > 0
```



## –ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ï—Å–ª–∏ `name` –Ω–µ —É–Ω–∏–∫–∞–ª–µ–Ω –≤ –º–∏—Ä–æ–≤–æ–º —Å–º—ã—Å–ª–µ _(–Ω–µ—Å–∫–æ–ª—å–∫–æ –ª—é–¥–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º)_ ‚Äî 
–≥—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø–æ `employee_id`, –∞ –Ω–µ –ø–æ `name`.

- `NULL` –≤ `lang` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è `COUNT(DISTINCT lang)`; 
–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É—á–µ—Å—Ç—å/–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å `NULL` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `WHERE lang IS NOT NULL` –ø–µ—Ä–µ–¥ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π.

- –£—á—Ç–∏—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä –∏ –ø—Ä–æ–±–µ–ª—ã: `'SQL' ‚â† 'sql'` –∏ `'SQL' ‚â† 'SQL '` ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–µ–Ω `TRIM()` –∏/–∏–ª–∏ `UPPER()`.

- –î—É–±–ª–∏ —Å—Ç—Ä–æ–∫: `COUNT(DISTINCT ...)` –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ª–æ–∂–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞ –∏–∑-–∑–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü –∏–Ω–¥–µ–∫—Å –ø–æ `(name, lang)` –ø–æ–º–æ–≥–∞–µ—Ç, 
–∞ –≤—ã–±–æ—Ä –º–µ–∂–¥—É `GROUP BY` –∏ `EXISTS` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∞–Ω–Ω—ã—Ö –∏ –°–£–ë–î.



## –ö–æ—Ä–æ—Ç–∫–∞—è –ø–∞–º—è—Ç–∫–∞ (—á—Ç–æ–±—ã –∑–∞–ø–æ–º–Ω–∏—Ç—å) üß†
**–ì—Ä—É–ø–ø–∏—Ä—É–π** ‚Üí **–ê–≥—Ä–µ–≥–∏—Ä—É–π** ‚Üí **–§–∏–ª—å—Ç—Ä—É–π**  
(`GROUP BY` ‚Üí `–∞–≥—Ä–µ–≥–∞—Ç—ã` ‚Üí `HAVING`). ‚úîÔ∏è

---

